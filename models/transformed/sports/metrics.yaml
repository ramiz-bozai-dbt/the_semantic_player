metrics:
  - name: count_passing_players
    type: simple
    type_params:
      measure: total_passing_players
    label: "Count distinct of players"

  - name: total_completions
    type: simple
    type_params:
      measure: total_completions
    label: "Total completed passes" 

  - name: total_attempts
    type: simple
    type_params:
      measure: total_attempts
    label: "Total attempted passes"     
    
  - name: completion_pct
    type: ratio
    type_params: # Required
      numerator: total_completions
      denominator: total_attempts
    label: "Passing completion percentage"     

  - name: qb_completion_pct
    type: ratio
    type_params: # Required
      numerator: 
        name: total_completions
        filter: "{{ Dimension('player_season_id__position') }} = 'QB'"
      denominator: 
        name: total_attempts
        filter: "{{ Dimension('player_season_id__position') }} = 'QB'"
    label: "Passing completion percentage"             

  # - name: qb_completion_pct
  #   type: derived
  #   type_params:
  #     expr: completion_pct
  #     metrics:
  #       - name: completion_pct
  #         filter: "{{ Dimension('player_season_id__position') }} = 'QB'"
  #   label: "Quarterback-only passing completion percentage"              

  - name: count_receiving_players
    type: simple
    type_params:
      measure: total_receiving_players
    label: "Count distinct of players"    

  - name: total_receiving_touchdowns
    type: simple
    type_params:
      measure: total_receiving_touchdowns
    label: "Count of receiving touchdowns"         

##Music related
  - name: total_songs_ranked
    type: simple
    type_params:
      measure: total_songs_ranked
    label: "Count distinct of songs ranked on the Billboard Top 100"  

  - name: total_appearances
    type: simple
    type_params:
      measure: total_appearances
    label: "Count distinct of appearances on the Billboard Top 100"         

